<script>
import 'leaflet/dist/leaflet.css';
import 'leaflet-defaulticon-compatibility/dist/leaflet-defaulticon-compatibility.webpack.css'; // Re-uses images from ~leaflet package
import L from 'leaflet';
import 'leaflet-defaulticon-compatibility';
import { LMap } from 'vue2-leaflet';

export default {
  name: "MyAwesomeMap",
  components: {
    LMap
  },
  data() {
    return {
        feat: null,
    };
  },
  mounted() {
    this.$nextTick(() => {
        let map =  this.$refs.myMap.mapObject;
        map.fitWorld();

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            //TODO CHANGE MAP PROVIDER -- see OSM terms
        }).addTo(map);

        map.locate({setView: false, maxZoom: 14});

        function onLocationFound(e) {
            var radius = e.accuracy;

            L.circle(e.latlng, radius).addTo(map);
        }

        map.on('locationfound', onLocationFound);

        function onLocationError(e) {
            alert(e.message);
        }

        map.on('locationerror', onLocationError);

        let popup = L.popup();

        function onMapClick(e) {
            popup
                .setLatLng(e.latlng)
                .setContent("You clicked the map at " + e.latlng.toString())
                .openOn(map);
        }

        map.on('click', onMapClick);

        let json = {"type":"MultiLineString","coordinates":[[[18.55800926,49.211931986],[18.5580344,49.2121715],[18.5580381,49.2135791],[18.5580568,49.213891],[18.55809,49.2148123],[18.5580834,49.215134],[18.5580834,49.2152663],[18.5580874,49.2153548],[18.5580891,49.2155954],[18.5580895,49.2156582],[18.5586664,49.2157591],[18.5591,49.2158381],[18.5603401,49.216051],[18.5613921,49.2162341],[18.5623638,49.216318],[18.5632982,49.2162733],[18.5645302,49.2161545],[18.565494,49.2160952],[18.5657396,49.216102],[18.5662548,49.2161593],[18.5666695,49.2162658],[18.5670961,49.216444],[18.5674679,49.2167039],[18.5677128,49.2169639],[18.5681273,49.2175834],[18.5682423,49.2177977],[18.5682586,49.2178238],[18.5683322,49.2179422],[18.5683563,49.2180973],[18.5683528,49.2182508],[18.5679613,49.2188346],[18.5664479,49.2210913],[18.5661246,49.2215698],[18.5656558,49.2222639],[18.5655134,49.2224711],[18.5654559,49.2225652],[18.5653034,49.2228104],[18.5652483,49.2228992],[18.565011,49.2232825],[18.5648667,49.2234982],[18.5645484,49.223952],[18.5636469,49.2252387],[18.563594,49.2253143],[18.5634931,49.2252987],[18.5633926,49.2253153],[18.5633152,49.2253604],[18.5632178,49.2253],[18.5628016,49.2250783],[18.5620555,49.2246721],[18.5618828,49.2245781],[18.5614472,49.2243428],[18.5612371,49.2241668],[18.561235,49.2241495],[18.5612284,49.2240943],[18.5611927,49.2240817],[18.5611754,49.2240578],[18.5611833,49.2240318],[18.560866,49.2237538],[18.560758,49.2236747],[18.5606957,49.223664],[18.5597457,49.2234252],[18.5595999,49.2234148],[18.5589485,49.2235955],[18.5587679,49.2236456],[18.5579841,49.2238618],[18.5579444,49.2239011],[18.5571002,49.2247423],[18.5567821,49.2246825],[18.5563243,49.2249168],[18.5560529,49.2251466],[18.5558219,49.2253994],[18.5555488,49.2256078],[18.5550469,49.2257353],[18.554918,49.2259682],[18.5544717,49.2257512],[18.5543462,49.2257595],[18.553854,49.2256821],[18.5534609,49.2255862],[18.5529442,49.2254705],[18.5524438,49.2253207],[18.5514979,49.2250058],[18.5515218,49.2249585],[18.5516616,49.2246818],[18.551670686,49.224642976]],[[18.55800926,49.211931986],[18.5583072,49.2119722],[18.5590448,49.2120897],[18.5593613,49.2121422],[18.5596993,49.2122053],[18.5601767,49.2122964],[18.5606327,49.2123945],[18.5611209,49.2125032],[18.5615915,49.2126159],[18.5623154,49.212822],[18.5626794,49.2129313],[18.5627988,49.2129673],[18.5630235,49.2130393],[18.5637531,49.2132706],[18.5644388,49.213502],[18.5672345,49.2145428],[18.5703743,49.2157041],[18.5725434,49.2165977],[18.5727007,49.2166625],[18.5733259,49.2169201],[18.5762687,49.2181486],[18.5797924,49.2196393],[18.5815012,49.2203189],[18.5824239,49.2206693],[18.5834163,49.2210127],[18.5845321,49.221356],[18.5850954,49.2215137],[18.5856626,49.2216475],[18.5867315,49.2218816],[18.5872358,49.2219832],[18.5877079,49.2220638],[18.5885464,49.2221626],[18.5916733,49.2225311],[18.5954225,49.2229334],[18.5990247,49.223331],[18.6007279,49.223543],[18.6019201,49.2236908],[18.602916,49.2238488],[18.6036649,49.2240107],[18.6043592,49.2241718],[18.6045472,49.2242194],[18.6061825,49.2246311],[18.6076829,49.2250162],[18.6088613,49.2252892],[18.6118275,49.225919],[18.6123523,49.2260402],[18.6128779,49.2261706],[18.6133825,49.2263059],[18.6138017,49.2264265],[18.6142813,49.2265782],[18.6153036,49.2269204],[18.6165646,49.2273624],[18.6168421,49.2274566],[18.6175789,49.2277321],[18.618224,49.2279835],[18.618701,49.2282023],[18.6194675,49.2285801],[18.6201757,49.2289961],[18.6207451,49.229382],[18.6212354,49.2297566],[18.6217622,49.2301505],[18.6238288,49.2317328],[18.6241942,49.2319796],[18.6246507,49.2322643],[18.6254763,49.2327322],[18.6261126,49.2330428],[18.6265806,49.2332574],[18.6270988,49.2334783],[18.6275773,49.2336602],[18.628395,49.2339364],[18.6294035,49.2342166],[18.6304705,49.2344607],[18.6334656,49.2350537],[18.6339729,49.23517],[18.6345104,49.2353268],[18.6350861,49.2355059],[18.6356378,49.235705],[18.6360558,49.2358573],[18.636738,49.2361493],[18.6371041,49.2363345],[18.6375025,49.2365345],[18.6378994,49.2367604],[18.6382803,49.2369986],[18.6386397,49.2372438],[18.6391413,49.2376221],[18.6396268,49.2380301],[18.6399299,49.2383191],[18.6400721,49.2384767],[18.6405213,49.2389994],[18.6409563,49.239554],[18.6410403,49.2396736],[18.6418389,49.2407544],[18.6421749,49.2411585],[18.6425059,49.2415111],[18.6427475,49.2417493],[18.6429781,49.2419717],[18.6432803,49.242233],[18.6436621,49.242546],[18.6439652,49.2427702],[18.6443675,49.2430451],[18.6447833,49.2432903],[18.6452607,49.2435617],[18.6457033,49.2437823],[18.6459929,49.2439259],[18.6464811,49.244136],[18.646929,49.2443182],[18.6473904,49.2444842],[18.6478416,49.2446287],[18.6485855,49.2448498],[18.6503775,49.2453573],[18.6513119,49.2456485],[18.6517379,49.2458081],[18.6522411,49.246007],[18.6529426,49.2463377],[18.6532948,49.2465185],[18.653647,49.246716],[18.6540178,49.2469451],[18.6543997,49.2471998],[18.6549405,49.2476193],[18.6553238,49.2479595],[18.6572881,49.2498812],[18.6575273,49.2501061],[18.6577839,49.2503466],[18.6581165,49.2506408],[18.6584542,49.250893],[18.6587461,49.2511143],[18.6595864,49.2516772],[18.6604262,49.2522074],[18.6613207,49.25271],[18.6617176,49.2529107],[18.6621238,49.2530953],[18.6625429,49.2532995],[18.6630364,49.2535254],[18.6634441,49.2537039],[18.6636534,49.2537906],[18.6638887,49.2538657],[18.6649494,49.2541962],[18.665972,49.2545125],[18.6668127,49.25472],[18.6676651,49.2549086],[18.6683523,49.2550408],[18.6689792,49.255151],[18.6694306,49.2552171],[18.6699024,49.2552631],[18.6706462,49.2553265],[18.6712311,49.2553489],[18.6717677,49.2553605],[18.6722022,49.25535],[18.6726528,49.2553325],[18.6731987,49.2552966],[18.6737579,49.2552408],[18.6742083,49.2551779],[18.6746699,49.2551023],[18.675285,49.2549893],[18.675945,49.2548414],[18.6765095,49.2546906],[18.6769943,49.2545455],[18.6774328,49.2544044],[18.6776708,49.2543195],[18.6779054,49.2542429],[18.6782617,49.2540949],[18.6789275,49.2538031],[18.6796107,49.2534302],[18.681008,49.2526417],[18.6824385,49.2518358],[18.6830354,49.2514515],[18.6834598,49.2511498],[18.6838947,49.2507944],[18.6841818,49.2505071],[18.6843845,49.2502867],[18.6845939,49.2500145],[18.6848017,49.2497305],[18.6851991,49.2490936],[18.6854512,49.2486453],[18.6856551,49.2482531],[18.6862564,49.2469572],[18.6864876,49.2464891],[18.6869669,49.2455956],[18.6873508,49.2449853],[18.6875498,49.2446604],[18.6877333,49.2444208],[18.6879607,49.2441477],[18.688262,49.2438498],[18.6884595,49.2436596],[18.6886485,49.2434922],[18.6888318,49.2433438],[18.6892334,49.2430389],[18.6898006,49.2426802],[18.6899867,49.2425667],[18.6902157,49.2424182],[18.6907566,49.2420188],[18.6916881,49.2413628],[18.6918908,49.2412245],[18.6921495,49.2410975],[18.6924833,49.2409756],[18.6935673,49.2406977],[18.6940866,49.2405463],[18.6946268,49.2403606],[18.6949959,49.2401896],[18.6968529,49.2391514],[18.6979367,49.2385191],[18.698803,49.237929],[18.6993981,49.2374708],[18.699963,49.236934],[18.7004943,49.2364346],[18.7010142,49.235966],[18.701555,49.2354977],[18.7021808,49.2351201],[18.7032004,49.2345957],[18.7069765,49.2330924],[18.7075241,49.232843],[18.7075951,49.232811],[18.7076883,49.2327583],[18.7077672,49.2327057],[18.7078371,49.2326542],[18.7079282,49.2325738],[18.7080438,49.232468],[18.7081379,49.2323666],[18.7082419,49.2322531],[18.7083246,49.2321516],[18.7084068,49.2320295],[18.7084821,49.2319101],[18.7085323,49.2318235],[18.7085753,49.231731],[18.7086609,49.2315286],[18.7089867,49.2308124],[18.7090342,49.2307268],[18.7090862,49.230632],[18.7091292,49.2305547],[18.7091804,49.2304839],[18.7093064,49.2303175],[18.7095411,49.2300574],[18.7097369,49.2298753],[18.7099125,49.229728],[18.7100015,49.2296579],[18.710194,49.2295318],[18.710385,49.2294149],[18.7107137,49.2292402],[18.7108823,49.229156],[18.7110498,49.2290869],[18.7114809,49.2289253],[18.711926,49.2287629],[18.7139357,49.2280703],[18.7139939,49.2280531],[18.7142357,49.2279753],[18.7145101,49.2278917],[18.7147862,49.227818],[18.7150927,49.2277431],[18.7154068,49.2276732],[18.715702,49.2276176],[18.7164618,49.2275088],[18.7170581,49.2274539],[18.717139,49.2274464],[18.7172901,49.227432],[18.7177599,49.227402],[18.7183455,49.227373],[18.7183518,49.2273135],[18.7184897,49.2270231],[18.7185533,49.2269411],[18.7188377,49.2266246],[18.7190732,49.2263141],[18.7192515,49.2260789],[18.7197352,49.2254162],[18.7214229,49.2232307],[18.7217618,49.2227936],[18.7213943,49.2227514],[18.7211946,49.2227245],[18.7209943,49.2227011],[18.720481,49.2226597],[18.7203142,49.2226404],[18.720145,49.2226175],[18.7199441,49.2225913],[18.7197346,49.2225579],[18.7195308,49.2225051],[18.719374,49.2224648],[18.7191709,49.2224157],[18.7189662,49.222354],[18.7188428,49.22231],[18.7187384,49.2222607],[18.7186151,49.2221968],[18.718499,49.2221345],[18.7183817,49.2220614],[18.718147,49.2219002],[18.7179411,49.221736],[18.71786,49.2216611],[18.7177882,49.2215959],[18.717746,49.2215484],[18.7176823,49.221468],[18.7176206,49.2213672],[18.7175079,49.2211631],[18.717294,49.2207826],[18.7174355,49.2207476],[18.7175341,49.2206967],[18.717592,49.2206269],[18.7179408,49.2200227],[18.7186678,49.218826],[18.7188537,49.218657],[18.7190638,49.2185032],[18.7191064,49.2184742],[18.7191975,49.218419],[18.7190226,49.218407],[18.717936,49.2183327],[18.7162705,49.2181626],[18.7159971,49.2181508],[18.7158759,49.2181455],[18.7158316,49.2181693],[18.715789,49.2181923],[18.7157623,49.2182047],[18.7157219,49.2181802],[18.7156659,49.2181468],[18.7156111,49.2181161],[18.7155446,49.218082],[18.7154688,49.2180491],[18.7153944,49.2180228],[18.7153394,49.2180066],[18.7152852,49.2179948],[18.7151818,49.2179751],[18.7150839,49.2179602],[18.7150009,49.2179506],[18.7149511,49.2179455],[18.7149039,49.2179427],[18.7148103,49.2179392],[18.7147178,49.2179366],[18.7146353,49.2179378],[18.71462,49.2178784],[18.7141084,49.2175422]],[[18.55800926,49.211931986],[18.5579938,49.2117847],[18.5579256,49.2115619],[18.5578048,49.2113483],[18.5576312,49.2111941],[18.5574815,49.211074],[18.5572525,49.2109537],[18.5569509,49.2108458],[18.5565309,49.2107525],[18.5563516,49.2107348],[18.5560736,49.2107746],[18.5558965,49.2108276],[18.5557683,49.2109023],[18.5556205,49.2110095],[18.5555648,49.211132],[18.5555653,49.2112675],[18.5556154,49.2113673],[18.5557181,49.2114991],[18.5559138,49.211589],[18.5561551,49.2116508],[18.5564538,49.2117515],[18.5578271,49.2119074],[18.55800926,49.211931986]]]};
        this.feat = L.geoJSON(json);
        this.feat.addTo(map);
        map.fitBounds(this.feat.getBounds());
    });
  },
};
</script>

<template>
  <l-map ref="myMap" style="height: 350px"> </l-map>
</template>
